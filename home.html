<!doctype html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dashboard Financeiro Pessoal</title>
    <link rel="stylesheet" href="css/style.css" />
  </head>
  <body>
    <div class="container">
      <!-- Sidebar -->
      <aside class="sidebar">
        <div class="logo">
          <h2>Finanças<span>Pro</span></h2>
        </div>
        <nav>
          <ul>
            <li class="active"><a href="#">Dashboard</a></li>
            <li><a href="#">Transações</a></li>
            <li><a href="#">Investimentos</a></li>
            <li><a href="#">Objetivos</a></li>
            <li><a href="#">Configurações</a></li>
          </ul>
        </nav>
      </aside>

      <!-- Main Content -->
      <main class="main-content">
        <header>
          <div class="header-left">
            <button id="mobile-menu-btn" class="mobile-menu-btn">
              <span></span><span></span><span></span>
            </button>
            <h1>Visão Geral</h1>
          </div>
          <div class="user-info">
            <span>Olá, Usuário</span>
            <div class="avatar"></div>
          </div>
        </header>

        <!-- Top Cards -->
        <section class="cards-grid">
          <div class="card balance">
            <h3>Saldo Atual</h3>
            <p class="value">R$ 0,00</p>
          </div>

          <div class="card salary">
            <div class="card-header-flex">
              <h3>Salário</h3>
              <button
                type="button"
                class="btn-received"
                id="btn-salary-received"
              >
                Atualizar
              </button>
            </div>
            <p class="value">R$ 0,00</p>
            <span class="date">Recebido em ...</span>
          </div>

          <div class="card expenses">
            <h3>Gastos Totais</h3>
            <p class="value">R$ 0,00</p>
            <div class="progress-bar">
              <div class="progress" style="width: 0%"></div>
            </div>
          </div>
        </section>

        <!-- Expenses -->
        <div class="expenses-container">
          <section class="expense-section future">
            <div class="section-header">
              <div class="title-group">
                <h2>Futuros Gastos</h2>
                <span class="badge warning"></span>
              </div>
              <button
                type="button"
                class="add-expense-btn"
                id="open-modal"
                title="Adicionar Futuro Gasto"
              >
                +
              </button>
            </div>
            <div class="expense-list"></div>
          </section>

          <section class="expense-section paid">
            <div class="section-header">
              <div class="title-group">
                <h2>Gastos Pagos</h2>
                <span class="badge success"></span>
              </div>
            </div>
            <div class="expense-list paid-expense"></div>
          </section>
        </div>

        <!-- Middle Section -->
        <div class="content-grid">
          <!-- Investments -->
          <section class="investments">
            <div class="section-header">
              <h2>Investimentos</h2>
              <a href="#" class="view-all">Ver todos</a>
            </div>
            <div class="invest-list">
              <div class="invest-item">
                <div class="icon-box crypto"></div>
                <div class="invest-info">
                  <h4>Criptoativos</h4>
                  <span>Bitcoin, Ethereum</span>
                </div>
                <div class="invest-value">
                  <p>R$ 12.400,00</p>
                  <span class="trend positive">+12%</span>
                </div>
              </div>
              <div class="invest-item">
                <div class="icon-box stocks"></div>
                <div class="invest-info">
                  <h4>Ações</h4>
                  <span>PETR4, VALE3</span>
                </div>
                <div class="invest-value">
                  <p>R$ 8.150,00</p>
                  <span class="trend negative">-2.4%</span>
                </div>
              </div>
            </div>
          </section>

          <!-- Goals -->
          <section class="goals">
            <div class="section-header">
              <h2>Objetivos</h2>
              <button class="add-btn" id="open-goal-modal">+</button>
            </div>
            <div class="goal-card">
              <div class="goal-header">
                <h4></h4>
                <span></span>
              </div>
              <div class="progress-bar">
                <div class="progress" style="width: 0%"></div>
              </div>
            </div>
            <div class="goal-card">
              <div class="goal-header">
                <h4></h4>
                <span></span>
              </div>
              <div class="progress-bar">
                <div class="progress" style="width: 0%"></div>
              </div>
            </div>
          </section>
        </div>
      </main>
    </div>

    <!-- MODAL DESPESA (CRIAÇÃO/EDIÇÃO) -->
    <div id="modal-gasto" class="modal-overlay">
      <div class="modal-content">
        <div class="modal-header">
          <h2 id="modal-title">Nova Despesa</h2>
          <button type="button" class="close-modal">&times;</button>
        </div>
        <form class="modal-form" id="expense-form">
          <input type="hidden" id="expense-id" name="id" />
          <div class="form-group">
            <label for="name">Nome da Despesa</label>
            <input
              type="text"
              id="name"
              name="name"
              placeholder="Ex: Supermercado"
              required
            />
          </div>
          <div class="form-group">
            <label for="value">Valor (R$)</label>
            <input
              type="number"
              id="value"
              name="value"
              step="0.01"
              placeholder="0,00"
              required
            />
          </div>
          <div class="form-group">
            <label for="date">Data de Vencimento</label>
            <input type="date" id="date" name="date" required />
          </div>
          <div class="form-group">
            <label for="categoria">Categoria</label>
            <select id="categoria" name="categoria">
              <option value="alimentacao">Alimentação</option>
              <option value="moradia">Moradia</option>
              <option value="transporte">Transporte</option>
              <option value="lazer">Lazer</option>
              <option value="outros">Outros</option>
            </select>
          </div>
          <div class="form-actions">
            <button type="button" class="btn-cancel">Cancelar</button>
            <button type="submit" class="btn-save">Salvar Despesa</button>
          </div>
        </form>
      </div>
    </div>

    <!-- MODAL DETALHES DA DESPESA -->
    <div id="modal-detalhes" class="modal-overlay">
      <div class="modal-content">
        <div class="modal-header">
          <h2>Detalhes da Despesa</h2>
          <button
            type="button"
            class="close-details-modal"
            id="close-details-modal"
          >
            &times;
          </button>
        </div>
        <div class="details-body">
          <div class="detail-item">
            <label>UUID:</label>
            <span id="detail-uuid">...</span>
          </div>
          <div class="detail-item">
            <label>Nome:</label>
            <span id="detail-name">...</span>
          </div>
          <div class="detail-item">
            <label>Valor:</label>
            <span id="detail-value">...</span>
          </div>
          <div class="detail-item">
            <label>Categoria:</label>
            <span id="detail-category">...</span>
          </div>
          <div class="detail-item">
            <label>Estado:</label>
            <span id="detail-status">...</span>
          </div>
          <div class="detail-item">
            <label>Vencimento:</label>
            <span id="detail-date">...</span>
          </div>
        </div>
        <div class="form-actions details-actions">
          <button type="button" class="btn-delete" id="btn-delete-expense">
            Deletar
          </button>
          <button type="button" class="btn-update" id="btn-edit-expense">
            Atualizar
          </button>
          <button type="button" class="btn-pay" id="btn-pay-expense">
            Pagar
          </button>
        </div>
      </div>
    </div>

    <!-- MODAL OBJETIVO -->
    <div id="modal-objetivo" class="modal-overlay">
      <div class="modal-content">
        <div class="modal-header">
          <h2>Novo Objetivo</h2>
          <button type="button" class="close-goal-modal">&times;</button>
        </div>
        <form class="modal-form" id="goal-form">
          <div class="form-group">
            <label>Nome do Objetivo</label>
            <input
              type="text"
              id="goal-name"
              placeholder="Ex: Comprar um carro"
              required
            />
          </div>
          <div class="form-group">
            <label>Valor do Objetivo (R$)</label>
            <input
              type="number"
              id="goal-value"
              step="0.01"
              placeholder="Ex: 50000"
              required
            />
          </div>
          <div class="form-actions">
            <button type="button" class="btn-cancel" id="cancel-goal">
              Cancelar
            </button>
            <button type="submit" class="btn-save">Salvar Objetivo</button>
          </div>
        </form>
      </div>
    </div>

    <!-- MODAL SALÁRIO -->
    <div id="modal-salario" class="modal-overlay">
      <div class="modal-content">
        <div class="modal-header">
          <h2>Adicionar Salário</h2>
          <button
            type="button"
            class="close-salary-modal"
            id="close-salary-modal-btn"
          >
            &times;
          </button>
        </div>
        <form class="modal-form" id="salary-form">
          <div class="form-group">
            <label for="salary-value">Valor do Salário (R$)</label>
            <input
              type="number"
              id="salary-value"
              name="salary-value"
              step="0.01"
              value="8500.00"
              required
            />
          </div>
          <div class="form-group">
            <label for="salary-date">Data de Recebimento</label>
            <input type="date" id="salary-date" name="salary-date" required />
          </div>
          <div class="form-actions">
            <button type="button" class="btn-cancel" id="cancel-salary">
              Cancelar
            </button>
            <button type="submit" class="btn-save">
              Confirmar e Adicionar
            </button>
          </div>
        </form>
      </div>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const menuBtn = document.getElementById("mobile-menu-btn");
        const sidebar = document.querySelector(".sidebar");
        let overlay = document.createElement("div");
        overlay.className = "sidebar-overlay";
        document.body.appendChild(overlay);

        const toggleMenu = () => {
          menuBtn.classList.toggle("active");
          sidebar.classList.toggle("active");
          overlay.classList.toggle("active");
        };

        menuBtn.addEventListener("click", toggleMenu);
        overlay.addEventListener("click", toggleMenu);
      });
    </script>
    <script>
      async function checkAuth() {
        try {
          const res = await fetch(
            "https://gestor-financas-api.onrender.com:3000/auth/me",
            {
              credentials: "include",
            },
          );
          if (!res.ok) window.location.href = "/login.html";
        } catch (err) {
          window.location.href = "/login.html";
        }
      }
      checkAuth();
    </script>
    <script type="module" src="js/home.js"></script>
    <script type="module" src="js/despesas.js"></script>
    <script type="module" src="js/objetivos.js"></script>
    <script type="module" src="js/modal-salario.js"></script>
    <script type="module" src="js/detalhes-despesa.js"></script>
  </body>
</html>
